<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <script type="module" src="https://esm.run/@material/web/all.js"></script>
   <!-- Bootstrap CSS -->
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
   <!-- jQuery -->
   <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
 
<script src="./js/bikes.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>  
  <title>ReviewPayment</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
    .highlight {
      background-color: #e0f3ff !important;
    }
    .selected {
      border: 2px solid #198754;
    }
    .park-logo {
      width: 40px;
      height: 40px;
      object-fit: contain;
      margin-right: 8px;
      vertical-align: middle;
    }
  
#userGreeting
{
  display: flex;
  justify-content: center;     /* horizontal centering */
  align-items: center;         /* vertical centering */
  color: white;
  text-align: center;
}
#banner
{
background-color: lightgrey;
height: 60px;
vertical-align: middle;
width: 100%;
display: flex;
justify-content: center;     /* horizontal centering */
align-items: center;         /* vertical centering */
}
    .payment-card {
      max-width: 700px;
      margin: 2rem auto;
    }
    .label {
      font-weight: bold;
    }  
#cancelBtn
{
width: 400px;
}

</style>
</head>
  

<body onload="checkpll(); checkUserStatus(); displayProfilePicture();gettransaction();">
    <!-- Navigation Bar -->
    <div class="navbar">
      <div class="nav-left">
            <div class="dropdown">
                  <button class="jsmenu"><img src="./images/greenmenu5.png"></button> 
                  <div class="dropdown-content">
                          <a href="index.html">Home</a>
                          <a href="login.html">Login</a>
                          <a href="logout.html">Logout</a>
                          <a href="welcome.html">Welcome</a>
                          <a href="licenses6.html">BuyNow</a>
                          <a href="reviews.html">AllReviews</a>
                          <a href="mylicenselogs.html">MyLicenseLogs</a>
                          <a href="mylicenses.html">MyLicenses</a>
                          <a href="./pricing/wizard.html">PricingWizard</a>
                          <a href="mycart.html?uid=1">MyCart</a>
                          <a href="myprofile.html">MyProfile</a>
                          <a href="testimonials.html">AdminTestimonials</a>
                          <a href="products.html">AdminProducts</a>
                          <a href="licensetypes.html">AdminLicenseTypes</a>
                          <a href="template.html">AdminPageTemplate</a>
            </div>
    </div> 
      <div class="logo">&nbsp&nbsp&nbsp<H5>GEM.LM</H5></div>
      </div>
      <div class="nav-right">
        <img src="./images/blackcircle.png" id="profilephototarget" alt="User" onclick="window.location.href='myprofile.html'" />
        <span id="H3UserBanner"></span>
        <div class="right-links" style="display:flex; gap:6px; align-items:center; color: white;">
  
          <md-text-button class="icon-only" href="index.html" aria-label="Home" title="Home">
            <span class="material-icons" style="color:white;">home</span>
          </md-text-button>
        
          <md-text-button class="icon-only" href="userhelp.html" aria-label="Help" title="Help">
            <span class="material-icons" style="color:white;">help_outline</span>
          </md-text-button>
        
          <md-text-button class="icon-only" href="usernotices.html" aria-label="Notifications" title="Notifications">
            <span class="material-icons" style="color:white;">notifications</span>
          </md-text-button>
        
          <md-text-button class="icon-only" href="login.html" aria-label="Login" title="Login">
            <span class="material-icons" style="color:white;">login</span>
          </md-text-button>
        
          <md-text-button class="icon-only" href="logout.html" aria-label="Logout" title="Logout">
            <span class="material-icons" style="color:white;">logout</span>
          </md-text-button>
        
           <md-text-button class="icon-only" href="myprofile.html" aria-label="My Profile" title="My Profile">
            <span class="material-icons" style="color:white;">person</span>
          </md-text-button>
        
           <md-text-button class="icon-only" href="mycart.html" aria-label="My Cart" title="My Cart">
            <span class="material-icons" style="color:white;">shopping_cart</span>
          </md-text-button>
        </div>
      </div>
    </div>
  <div align="center" id="banner"><span id="userGreeting">Welcome Guest</span></div>

   <div class="container2">
    <h3 class="text-center mt-4">Payment Details</h3>
    <div class="card payment-card">
      <div class="card-body" id="paymentDetails">
        <div id="transactioninfo">Loading payment information...</div>
      </div>
    </div>
  </div>

  <script>
   function gettransaction() {
      const urlParams = new URLSearchParams(window.location.search);
      const paymentId = urlParams.get("id");

      if (!paymentId) {
        $("#transactioninfo").html("<p class='text-danger'>No payment ID provided in the URL.</p>");
        return;
      }

      $.ajax({
        url: `https://api242.onrender.com/Payments/transactions/${paymentId}`,
        method: "GET",
        success: function (payments) {
          if (!Array.isArray(payments) || payments.length === 0) {
            $("#transactioninfo").html("<p class='text-warning'>No payment record found for this ID.</p>");
            return;
          }

          const payment = payments[0];

          $("#transactioninfo").html(`
            <p><span class="label">Payment ID:</span> ${payment.paymentId}</p>
            <p><span class="label">Booking ID:</span> ${payment.bookingId}</p>
            <p><span class="label">Transaction ID:</span> ${payment.transactionId}</p>
            <p><span class="label">Amount Paid:</span> $${parseFloat(payment.amountPaid).toFixed(2)}</p>
            <p><span class="label">Payment Method:</span> ${payment.paymentMethod}</p>
            <p><span class="label">Card Type:</span> ${payment.cardType}</p>
            <p><span class="label">Card Last 4:</span> ${payment.cardLast4}</p>
            <p><span class="label">Card Expiry:</span> ${payment.cardExpDate}</p>
            <p><span class="label">Payment Date:</span> ${new Date(payment.paymentDate).toLocaleString()}</p>
            <p><span class="label">User ID:</span> ${payment.useridasstring ?? "—"}</p>
            <p><span class="label">Transaction Type:</span> ${payment.transtype ?? "—"}</p>
          `);
        },
        error: function () {
          $("#transactioninfo").html("<p class='text-danger'>Failed to load payment details. Please try again later.</p>");
        }
      });
    }
</script>

  </script>

  <footer class="footer text-center mt-5">
    &copy; Greenville Associates Consulting <br> All rights reserved.<br>
    <a href="sitemap.html" class="sitelink">SiteMap</a>
  </footer>
</body>
</html>
